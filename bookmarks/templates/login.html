{% extends 'base.html' %}
{% load static %}
{% block title %}Login - MarkVault{% endblock %}

{% block extra_head %}
<style>
  /* Split layout */
  .auth-split{ min-height: calc(100vh - 64px); }
  .auth-ill{
    background:
      radial-gradient(420px 260px at 25% 25%, rgba(20, 219, 241, 0.12), transparent 55%),
      linear-gradient(180deg, rgba(20, 138, 241, 0.06), transparent);
    border-right:1px solid var(--hx-border);
  }
  .auth-ill img{
    width:100%; height:100%; object-fit:cover; opacity:.85; mix-blend-mode:screen;
  }

  /* Neon icon bubble */
  .icon-bubble{
    width:48px; height:48px; border-radius:50%;
    display:inline-flex; align-items:center; justify-content:center;
    background:rgba(20, 212, 241, 0.08);
    border:1px solid var(--hx-border);
    box-shadow:0 0 0 3px rgba(20, 193, 241, 0.08), 0 0 18px rgba(20, 230, 241, 0.35) inset;
    color:var(--hx-primary);
  }

  /* Dark inputs */
  .form-control, .form-select{
    background:#0b1220; color:var(--hx-text);
    border:1px solid var(--hx-border);
  }
  .form-control::placeholder{ color:#64748b; }
  .form-control:focus, .form-select:focus{
    border-color:var(--hx-primary-700);
    box-shadow:0 0 0 .2rem rgba(20, 241, 237, 0.15);
    background:#0b1220; color:var(--hx-text);
  }
  .input-group-text{
    background:#0b1220; color:var(--hx-muted);
    border:1px solid var(--hx-border);
    border-right:0;
  }
  .btn, .input-group-text{ border-radius:.75rem; }
  .card{ border-radius:1rem; }

  .link-neon{ color:var(--hx-primary); text-decoration:none; }
  .link-neon:hover{ text-decoration:underline; }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row auth-split g-0">
    <!-- Left: image/visual -->
    <div class="col-lg-6 d-none d-lg-block auth-ill">
      <!-- Replace with your cyber image -->
      <img src="{% static 'img/mark-vault.jpg' %}" alt="Cyber grid">
    </div>

    <!-- Right: form -->
    <div class="col-12 col-lg-6 d-flex align-items-center justify-content-center py-5">
      <div class="bm-card bm-shadow p-4 p-md-5" style="max-width:520px;width:100%;">
        <div class="text-center mb-3">
          <span class="icon-bubble mb-2"><i class="fas fa-sign-in-alt"></i></span>
          <h3 class="bm-title mb-1">Login</h3>
          <p class="bm-muted small mb-0">Welcome back! Please enter your Login Details</p>
        </div>

        <form method="post" id="loginForm" novalidate>
          {% csrf_token %}
          <div class="mb-3">
            <label class="form-label">Username</label>
            <div class="input-group">
              <span class="input-group-text"><i class="fas fa-user"></i></span>
              <input type="text" name="username" class="form-control" placeholder="Enter username" required>
            </div>
          </div>

          <div class="mb-2">
            <label class="form-label">Password</label>
            <div class="input-group">
              <span class="input-group-text"><i class="fas fa-lock"></i></span>
              <input type="password" name="password" class="form-control" placeholder="Enter password" required id="passwordInput">
              <button type="button" class="btn btn-outline-secondary" id="togglePw" aria-label="Show/Hide password">
                <i class="far fa-eye"></i>
              </button>
            </div>
            <small id="capsHint" class="text-warning d-none">Caps Lock is ON</small>
          </div>

          <button type="submit" class="btn btn-primary w-100 mt-3 mono">
            <i class="fas fa-sign-in-alt me-1"></i> Login
          </button>
        </form>

        <p class="text-center mt-3 mb-0">
          Don't have an account? <a class="link-neon" href="{% url 'signup' %}">Signup</a>
        </p>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  // Show/Hide password
  const togglePw = document.getElementById('togglePw');
  const pwInput = document.getElementById('passwordInput');
  togglePw.addEventListener('click', ()=>{
    pwInput.type = pwInput.type === 'password' ? 'text' : 'password';
    const icon = togglePw.querySelector('i');
    icon.classList.toggle('fa-eye');
    icon.classList.toggle('fa-eye-slash');
  });

  // Caps Lock hint
  pwInput.addEventListener('keyup', (e)=>{
    const caps = e.getModifierState && e.getModifierState('CapsLock');
    document.getElementById('capsHint').classList.toggle('d-none', !caps);
  });

  // Optional: basic UI validation
  document.getElementById('loginForm').addEventListener('submit', (e)=>{
    const u = e.target.querySelector('input[name="username"]').value.trim();
    const p = e.target.querySelector('input[name="password"]').value.trim();
    if(!u || !p){
      e.preventDefault();
      Swal.fire({ icon:'warning', title:'Missing fields', text:'Please enter both username and password.' });
    }
  });
</script>
{% endblock %}
